<a
    href="{% url 'offer' offer.id %}"
    class="card
           {% if offer.filled %}
               bg-base-300
           {% elif offer.moderation and not offer.moderation.passed %}
               bg-error
           {% else %}
               bg-base-100
           {% endif %}
           transition-all duration-300 cursor-pointer select-none
           focus:outline-none focus:ring-2 focus:ring-primary
           w-full"
    x-data="{ clicked:false, touched:false }"
    :class="{
        'shadow-md hover:shadow-xl translate-y-0 hover:-translate-y-1': !clicked && !touched,
        'opacity-50 shadow-sm hover:shadow-sm translate-y-1 hover:translate-y-0.5': clicked && !touched,
        'opacity-50 shadow-none hover:shadow-none translate-y-1 hover:translate-y-1': !clicked && touched
    }"
    @mousedown="clicked = true"
    @mouseup="clicked = false"
    @mouseleave="clicked = false"
    @touchstart="clicked = true; touched = true"
    @touchend="clicked = false"
    @touchcancel="clicked = false"

    {% if last == 1 %}
        hx-get="/offers/{{ page_next }}"
        hx-trigger="revealed"
        hx-target="#list_offers"
        hx-swap="beforeend"
        hx-indicator="#spinner"
    {% endif %}
>
    <div class="card-body">
        <!-- Titre + ic√¥ne + badge NEW -->
        <h2 class="card-title flex justify-between">
            {% if offer.section == "artists_groups" %}
                üé≠
            {% elif offer.section == "courses_training" %}
                üéì
            {% elif offer.section == "calls_events" %}
                üì£
            {% elif offer.section == "services_equipment" %}
                üõ†Ô∏è
            {% else %}
                ‚ùì
            {% endif %}

            {{ offer.title|capfirst }}

            {% if offer.recent %}
                <span class="badge badge-accent">NEW</span>
            {% endif %}
        </h2>

        <!-- R√©sum√© -->
        <p class="overflow-hidden text-ellipsis">
            {{ offer.summary }}
        </p>

        <!-- Bas de carte : date + badges -->
        <div class="flex items-center justify-between">
            <time class="italic">
                {{ offer.created_on|date:"d/m/Y" }}
            </time>

            <div class="flex flex-wrap justify-end items-center gap-2">

                {# TYPE / SECTION #}
                {% if offer.type == 'offer' %}
                    {% if offer.section == 'artists_groups' %}
                        <span class="badge badge-primary badge-soft">Je recrute</span>
                    {% elif offer.section == 'courses_training' %}
                        <span class="badge badge-primary badge-soft">Je propose</span>
                    {% elif offer.section == 'calls_events' %}
                        <span class="badge badge-primary badge-soft">Je programme</span>
                    {% elif offer.section == 'services_equipment' %}
                        <span class="badge badge-primary badge-soft">Je propose</span>
                    {% endif %}
                {% else %}
                    {% if offer.section == 'artists_groups' %}
                        <span class="badge badge-primary">Je postule</span>
                    {% elif offer.section == 'courses_training' %}
                        <span class="badge badge-primary">Je recherche</span>
                    {% elif offer.section == 'calls_events' %}
                        <span class="badge badge-primary">Je me produis</span>
                    {% elif offer.section == 'services_equipment' %}
                        <span class="badge badge-primary">Je recherche</span>
                    {% endif %}
                {% endif %}

                {# GRATUIT / PAYANT, etc. #}
                {% if offer.category == 'paid' %}
                    {% if offer.section in 'artists_groups calls_events' %}
                        <span class="badge badge-secondary">R√©mun√©r√©</span>
                    {% else %}
                        <span class="badge badge-secondary">Payant</span>
                    {% endif %}
                {% else %}
                    {% if offer.section in 'artists_groups calls_events' %}
                        <span class="badge badge-soft badge-secondary">B√©n√©vole</span>
                    {% else %}
                        <span class="badge badge-soft badge-secondary">Gratuit</span>
                    {% endif %}
                {% endif %}

            </div>
        </div>
    </div>
</a>
